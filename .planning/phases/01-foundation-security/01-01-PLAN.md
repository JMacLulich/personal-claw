---
phase: 01-foundation-security
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - requirements.txt
  - .env.example
  - .gitignore
  - src/__init__.py
  - src/config.py
autonomous: true

must_haves:
  truths:
    - "Python environment exists with all required dependencies installed"
    - "Configuration can be loaded from environment variables"
    - "Secrets are never committed to git"
  artifacts:
    - path: "requirements.txt"
      provides: "Project dependencies"
      contains: "py-cord"
    - path: "src/config.py"
      provides: "Configuration management"
      exports: ["Config", "load_config"]
    - path: ".env.example"
      provides: "Required environment variable template"
      contains: "DISCORD_BOT_TOKEN"
  key_links:
    - from: "src/config.py"
      to: ".env"
      via: "python-dotenv load"
      pattern: "load_dotenv"
---

<objective>
Set up Python project foundation with dependency management and secure configuration.

Purpose: Establishes the base environment for Discord bot and Gmail integration with security-first configuration management.

Output: Working Python project structure with dependencies installed and configuration framework ready.
</objective>

<execution_context>
@/Users/jasonmaclulich/.config/opencode/get-shit-done/workflows/execute-plan.md
@/Users/jasonmaclulich/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
</context>

<tasks>

<task type="auto">
  <name>Create project structure and dependencies</name>
  <files>
    requirements.txt
    .gitignore
    src/__init__.py
  </files>
  <action>
Create Python project structure:

1. Create `requirements.txt` with dependencies:
   - py-cord>=2.7.0 (Discord bot framework)
   - google-api-python-client>=2.0.0 (Gmail API)
   - google-auth-oauthlib>=1.0.0 (OAuth for Gmail)
   - google-auth-httplib2>=0.2.0 (HTTP transport for Gmail)
   - python-dotenv>=1.0.0 (Environment variable management)

2. Create `.gitignore`:
   - .env (secrets)
   - token.json (Gmail OAuth tokens)
   - __pycache__/
   - *.pyc
   - .venv/
   - venv/

3. Create `src/` directory with `__init__.py`

4. Install dependencies: `pip install -r requirements.txt`
  </action>
  <verify>
Run: `pip list | grep -E "(py-cord|google-api-python-client|python-dotenv)"`
All three libraries should appear in output
  </verify>
  <done>
requirements.txt exists with correct dependencies, .gitignore blocks secrets, dependencies installed successfully
  </done>
</task>

<task type="auto">
  <name>Create configuration management</name>
  <files>
    src/config.py
    .env.example
  </files>
  <action>
Create configuration system:

1. Create `src/config.py` with:
   - `Config` dataclass with fields:
     - discord_bot_token: str
     - discord_allowlisted_user_id: int
     - gmail_credentials_path: str (default: "credentials.json")
     - gmail_token_path: str (default: "token.json")
   - `load_config()` function that:
     - Uses python-dotenv to load .env
     - Validates required fields are present
     - Returns Config instance
     - Raises clear error if required vars missing

2. Create `.env.example` template with:
   ```
   DISCORD_BOT_TOKEN=your_bot_token_here
   DISCORD_ALLOWLISTED_USER_ID=your_discord_user_id_here
   GMAIL_CREDENTIALS_PATH=credentials.json
   GMAIL_TOKEN_PATH=token.json
   ```

Design notes:
- Use dataclasses for clean config structure
- Fail fast on missing required config (don't default tokens to empty string)
- Make Gmail paths configurable for testing flexibility
  </action>
  <verify>
Run: `python -c "from src.config import Config, load_config; print('Config system works')"`
Should output "Config system works" (will fail on missing .env, which is expected)
  </verify>
  <done>
src/config.py provides Config dataclass and load_config function, .env.example documents all required environment variables
  </done>
</task>

<task type="auto">
  <name>Verify project foundation</name>
  <files>
    README.md
  </files>
  <action>
Create `README.md` documenting setup:

1. Project description (Personal-Claw - Financial anxiety reduction via Discord)
2. Setup steps:
   - Copy .env.example to .env
   - Fill in required values
   - Install dependencies: `pip install -r requirements.txt`
3. Required secrets:
   - Discord bot token (from Discord Developer Portal)
   - Discord user ID (Jason's allowlisted ID)
   - Gmail credentials.json (from Google Cloud Console)
4. Architecture note: "Bot only responds to allowlisted user ID for security"

Test the setup:
- Create a temporary .env with dummy values
- Verify load_config() fails with clear message on invalid token format
- Verify load_config() succeeds with valid dummy values
- Clean up temporary .env
  </action>
  <verify>
Check: README.md exists and documents setup process
Run: `python -c "from src.config import load_config"` (expect failure with no .env)
  </verify>
  <done>
README.md documents setup, config system validates required variables, project foundation complete
  </done>
</task>

</tasks>

<verification>
Overall checks:
- [ ] All dependencies installed (`pip list` shows py-cord, google-api-python-client, python-dotenv)
- [ ] src/config.py can be imported
- [ ] .env.example documents all required variables
- [ ] .gitignore blocks .env and token.json from git
- [ ] README.md explains setup process
</verification>

<success_criteria>
1. Python environment has all required dependencies
2. Configuration system can load from .env
3. Secrets are excluded from git via .gitignore
4. README documents setup for future deployment
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation-security/01-01-SUMMARY.md`
</output>
